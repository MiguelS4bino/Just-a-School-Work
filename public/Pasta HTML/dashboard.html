<!DOCTYPE html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FlashMind - Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            fontFamily: {
              sans: ["Inter", "sans-serif"],
            },
            animation: {
              "fade-in": "fadeIn 0.5s ease-in-out",
              float: "float 3s ease-in-out infinite",
              "pulse-slow": "pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite",
            },
            keyframes: {
              fadeIn: {
                "0%": { opacity: "0", transform: "translateY(10px)" },
                "100%": { opacity: "1", transform: "translateY(0)" },
              },
              float: {
                "0%, 100%": { transform: "translateY(0)" },
                "50%": { transform: "translateY(-3px)" },
              },
            },
            colors: {
              "dark-blue": "#0f172a",
              "darker-blue": "#0a1120",
              "light-blue": "#1e40af",
              "lighter-blue": "#3b82f6",
            },
          },
        },
      };
    </script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="../Pasta CSS/dashboard.css">
  </head>

  <body class="bg-darker-blue text-gray-100 font-sans min-h-screen">
    
    <!-- Navbar -->
    <nav
      class="fixed top-0 left-0 right-0 z-50 py-4 px-6 md:px-12 flex items-center justify-between bg-dark-blue bg-opacity-90 backdrop-blur-sm border-b border-gray-800"
    >
      <div class="flex items-center space-x-3">
        <i class="fas fa-brain text-3xl gradient-text animate-float"></i>
        <span class="text-2xl font-bold gradient-text">FlashMind</span>
      </div>
      <div class="hidden md:flex space-x-8">
        <a
          href="#"
          class="text-gray-400 hover:text-white transition duration-300 hover:scale-105"
          >Dashboard</a
        >
        <a
          href="#"
          class="text-gray-400 hover:text-white transition duration-300 hover:scale-105"
          >Ranking</a
        >
        <a
          href="#"
          class="text-gray-400 hover:text-white transition duration-300 hover:scale-105"
          >Configurações</a
        >
      </div>
      <button class="md:hidden text-gray-400 hover:text-white transition">
        <i class="fas fa-bars text-xl"></i>
      </button>
    </nav>

    <!-- Main Content -->
    <div class="flex pt-16">
      <!-- Sidebar -->
      <aside
        class="hidden md:flex md:w-64 flex-col justify-between p-6 bg-dark-blue border-r border-gray-800 h-screen sticky top-0"
      >
        <div>
          <div class="flex flex-col items-center text-center mb-8">
            <div class="relative group w-24 h-24 rounded-full overflow-hidden border-4 border-blue-500">
              <img
                id="foto-usuario"
                src=""
                alt="Foto do usuário"
                class="w-full h-full object-cover transition-opacity duration-300 group-hover:opacity-60"
              />
              <label
                for="uploadInput"
                class="absolute inset-0 bg-black bg-opacity-50 text-white text-center flex items-center justify-center opacity-0 group-hover:opacity-100 cursor-pointer text-sm"
              >
                Alterar
              </label>
              <input id="uploadInput" type="file" accept="image/*" class="hidden" />
            </div>
            <div class="mt-4">
              <span class="text-yellow-400 text-xl"><i class="fas fa-trophy"></i></span>
              <h2 id="nome-usuario" class="font-semibold mt-1 text-lg">Carregando...</h2>
              <p id="nivel-usuario" class="text-sm text-gray-300">Nível 1</p>
            </div>

            <!-- Barra de XP -->
            <div class="w-full mt-4">
              <div class="w-full bg-gray-700 rounded-full h-2">
                <div class="bg-blue-500 h-2 rounded-full" style="width: 40%"></div>
              </div>
              <p id="xp-text" class="text-xs text-gray-400 mt-1">XP: 0 / 300</p>
            </div>
          </div>

          <nav>
            <ul class="space-y-4 text-sm">
              <li>
                <a href="#" id="dashboard-link" class="flex items-center space-x-3 text-blue-400 hover:text-white transition">
                  <i class="fas fa-home w-5 text-center"></i>
                  <span>Dashboard</span>
                </a>
              </li>
              <li>
                <a href="#" id="community-link" class="flex items-center space-x-3 text-gray-400 hover:text-white transition">
                  <i class="fas fa-users w-5 text-center"></i>
                  <span>Comunidade</span>
                </a>
              </li>
              <li>
                <a href="#" id="achievements-link" class="flex items-center space-x-3 text-gray-400 hover:text-white transition">
                  <i class="fas fa-trophy w-5 text-center"></i>
                  <span>Conquistas</span>
                </a>
              </li>
              <li>
                <a href="#" id="stats-link" class="flex items-center space-x-3 text-gray-400 hover:text-white transition">
                  <i class="fas fa-chart-line w-5 text-center"></i>
                  <span>Estatísticas</span>
                </a>
              </li>
              <li>
                <a href="#" id="settings-link" class="flex items-center space-x-3 text-gray-400 hover:text-white transition">
                  <i class="fas fa-cog w-5 text-center"></i>
                  <span>Configurações</span>
                </a>
              </li>
              <li>
                <a
                  href="#"
                  id="logout-link"
                  class="flex items-center space-x-3 text-gray-400 hover:text-red-400 transition"
                >
                  <i class="fas fa-sign-out-alt w-5 text-center"></i>
                  <span>Sair</span>
                </a>
              </li>
            </ul>
          </nav>
        </div>

        <div class="text-xs text-gray-500">
          <p>©2025 FlashMind</p>
          <p>Todos os direitos reservados</p>
        </div>
      </aside>

      <!-- Main Content Area -->
      <main class="flex-1 p-6 md:p-8 overflow-y-auto">
        <!-- Welcome Banner -->
        <div class="bg-gradient-to-r from-blue-900 to-blue-800 rounded-2xl p-6 mb-8 relative overflow-hidden">
          <div class="relative z-10">
            <h1 class="text-2xl md:text-3xl font-bold text-white mb-2">Bem-vindo de volta, <span id="welcome-name">Usuário</span>!</h1>
            <p class="text-blue-200 max-w-2xl">
              Continue sua jornada de aprendizado. Complete desafios, ganhe XP e suba no ranking!
            </p>
            <button
              id="btnEntrar"
              class="mt-4 bg-white text-blue-800 hover:bg-blue-100 font-medium py-2 px-6 rounded-full transition duration-300 transform hover:scale-105"
            >
              Jogar Agora
            </button>
          </div>
          <div class="absolute -right-10 -bottom-10 opacity-20">
            <i class="fas fa-brain text-[200px] text-white"></i>
          </div>
        </div>

        <!-- Stats Grid -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
          <!-- XP Card -->
          <div class="bg-dark-blue rounded-xl p-6 shadow-lg border border-blue-900/30">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-blue-400">Experiência</p>
                <h3 class="text-2xl font-bold" id="xp-stat">0 XP</h3>
                <p class="text-xs text-gray-400 mt-1">Próximo nível em <span id="xp-remaining">300</span> XP</p>
              </div>
              <div class="w-14 h-14 bg-blue-900/20 rounded-full flex items-center justify-center">
                <i class="fas fa-bolt text-blue-400 text-xl"></i>
              </div>
            </div>
          </div>

          <!-- Level Card -->
          <div class="bg-dark-blue rounded-xl p-6 shadow-lg border border-blue-900/30">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-blue-400">Nível</p>
                <h3 class="text-2xl font-bold" id="level-stat">1</h3>
                <p class="text-xs text-gray-400 mt-1">Progresso na jornada</p>
              </div>
              <div class="w-14 h-14 bg-blue-900/20 rounded-full flex items-center justify-center">
                <i class="fas fa-level-up-alt text-blue-400 text-xl"></i>
              </div>
            </div>
          </div>

          <!-- Streak Card -->
          <div class="bg-dark-blue rounded-xl p-6 shadow-lg border border-blue-900/30">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-blue-400">Sequência</p>
                <h3 class="text-2xl font-bold" id="streak-stat">0 dias</h3>
                <p class="text-xs text-gray-400 mt-1">Dias consecutivos</p>
              </div>
              <div class="w-14 h-14 bg-blue-900/20 rounded-full flex items-center justify-center">
                <i class="fas fa-fire text-blue-400 text-xl"></i>
              </div>
            </div>
          </div>

          <!-- Rank Card -->
          <div class="bg-dark-blue rounded-xl p-6 shadow-lg border border-blue-900/30">
            <div class="flex items-center justify-between">
              <div>
                <p class="text-sm text-blue-400">Ranking</p>
                <h3 class="text-2xl font-bold" id="rank-stat">#---</h3>
                <p class="text-xs text-gray-400 mt-1">Entre todos os jogadores</p>
              </div>
              <div class="w-14 h-14 bg-blue-900/20 rounded-full flex items-center justify-center">
                <i class="fas fa-trophy text-blue-400 text-xl"></i>
              </div>
            </div>
          </div>
        </div>

        <!-- Main Content Sections -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
          <!-- Left Column -->
          <div class="lg:col-span-2 space-y-6">
            <!-- Quick Play Section -->
            <div class="bg-dark-blue rounded-xl p-6 shadow-lg border border-blue-900/30">
              <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold">Modos de Jogo</h2>
                <div class="flex space-x-2">
                  <button class="text-xs bg-blue-900/30 text-blue-400 px-3 py-1 rounded-full">
                    Ver todos
                  </button>
                </div>
              </div>

              <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Casual Mode -->
                <div class="game-card bg-blue-900/20 rounded-lg p-5 border border-blue-800/30 cursor-pointer">
                  <div class="flex items-center space-x-4">
                    <div class="bg-blue-900/30 p-3 rounded-full">
                      <i class="fas fa-gamepad text-blue-400 text-xl"></i>
                    </div>
                    <div>
                      <h3 class="font-semibold">Casual</h3>
                      <p class="text-xs text-blue-300">Jogo rápido e divertido</p>
                    </div>
                  </div>
                  <button
                    class="mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg text-sm transition" id="btnCasual"
                  >
                    Jogar
                  </button>
                </div>

                <!-- Competitive Mode -->
                <div class="game-card bg-blue-900/20 rounded-lg p-5 border border-blue-800/30 cursor-pointer">
                  <div class="flex items-center space-x-4">
                    <div class="bg-blue-900/30 p-3 rounded-full">
                      <i class="fas fa-trophy text-yellow-400 text-xl"></i>
                    </div>
                    <div>
                      <h3 class="font-semibold">Competitivo</h3>
                      <p class="text-xs text-blue-300">Ganhe pontos de ranking</p>
                    </div>
                  </div>
                  <button
                    class="mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg text-sm transition" id="btnRanked"
                  >
                    Jogar
                  </button>
                </div>

                <!-- Challenge Mode -->
                <div class="game-card bg-blue-900/20 rounded-lg p-5 border border-blue-800/30 cursor-pointer">
                  <div class="flex items-center space-x-4">
                    <div class="bg-blue-900/30 p-3 rounded-full">
                      <i class="fas fa-chess text-purple-400 text-xl"></i>
                    </div>
                    <div>
                      <h3 class="font-semibold">Desafio</h3>
                      <p class="text-xs text-blue-300">Desafie um amigo</p>
                    </div>
                  </div>
                  <button
                    class="mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg text-sm transition" id="btnFriendlyChallenge"
                  >
                    Jogar
                  </button>
                </div>

                <!-- Practice Mode -->
                <div class="game-card bg-blue-900/20 rounded-lg p-5 border border-blue-800/30 cursor-pointer">
                  <div class="flex items-center space-x-4">
                    <div class="bg-blue-900/30 p-3 rounded-full">
                      <i class="fas fa-book text-green-400 text-xl"></i>
                    </div>
                    <div>
                      <h3 class="font-semibold">Prática</h3>
                      <p class="text-xs text-blue-300">Aprenda no seu ritmo</p>
                    </div>
                  </div>
                  <button
                    class="mt-4 w-full bg-blue-600 hover:bg-blue-700 text-white py-2 px-4 rounded-lg text-sm transition" id="btnPractice"
                  >
                    Jogar
                  </button>
                </div>
              </div>
            </div>

            <!-- Recent Activity -->
            <div class="bg-dark-blue rounded-xl p-6 shadow-lg border border-blue-900/30">
              <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold">Atividade Recente</h2>
                <button class="text-xs bg-blue-900/30 text-blue-400 px-3 py-1 rounded-full">
                  Ver histórico
                </button>
              </div>

              <div class="space-y-4">
                <div class="flex items-start space-x-3 p-3 rounded-lg bg-blue-900/10">
                  <div class="bg-blue-900/20 p-2 rounded-full">
                    <i class="fas fa-trophy text-yellow-400 text-sm"></i>
                  </div>
                  <div>
                    <p class="text-sm">
                      <span class="font-medium">Você</span> completou o desafio "Matemática Básica"
                    </p>
                    <p class="text-xs text-blue-300 mt-1">+50 XP • 15 minutos atrás</p>
                  </div>
                </div>

                <div class="flex items-start space-x-3 p-3 rounded-lg bg-blue-900/10">
                  <div class="bg-blue-900/20 p-2 rounded-full">
                    <i class="fas fa-level-up-alt text-blue-400 text-sm"></i>
                  </div>
                  <div>
                    <p class="text-sm">
                      <span class="font-medium">Você</span> subiu para o nível 3
                    </p>
                    <p class="text-xs text-blue-300 mt-1">+100 XP • 2 horas atrás</p>
                  </div>
                </div>

                <div class="flex items-start space-x-3 p-3 rounded-lg bg-blue-900/10">
                  <div class="bg-blue-900/20 p-2 rounded-full">
                    <i class="fas fa-book text-green-400 text-sm"></i>
                  </div>
                  <div>
                    <p class="text-sm">
                      <span class="font-medium">Você</span> completou uma sessão de prática
                    </p>
                    <p class="text-xs text-blue-300 mt-1">Ontem às 18:30</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Right Column -->
          <div class="space-y-6">
            <!-- Achievements -->
            <div class="bg-dark-blue rounded-xl p-6 shadow-lg border border-blue-900/30">
              <div class="flex items-center justify-between mb-6">
                <h2 class="text-xl font-bold">Conquistas</h2>
                <button class="text-xs bg-blue-900/30 text-blue-400 px-3 py-1 rounded-full">
                  Ver todas
                </button>
              </div>

              <div class="grid grid-cols-2 gap-4">
                <div class="achievement-card bg-blue-900/10 rounded-lg p-4 text-center border border-blue-800/30">
                  <div class="w-12 h-12 bg-blue-900/20 rounded-full flex items-center justify-center mx-auto mb-2">
                    <i class="fas fa-medal text-yellow-400 text-xl"></i>
                  </div>
                  <h3 class="text-sm font-medium">Primeiros Passos</h3>
                  <p class="text-xs text-blue-300">Complete seu primeiro jogo</p>
                </div>

                <div class="achievement-card bg-blue-900/10 rounded-lg p-4 text-center border border-blue-800/30 opacity-50">
                  <div class="w-12 h-12 bg-blue-900/20 rounded-full flex items-center justify-center mx-auto mb-2">
                    <i class="fas fa-fire text-orange-400 text-xl"></i>
                  </div>
                  <h3 class="text-sm font-medium">Sequência</h3>
                  <p class="text-xs text-blue-300">Jogue 7 dias seguidos</p>
                </div>

                <div class="achievement-card bg-blue-900/10 rounded-lg p-4 text-center border border-blue-800/30 opacity-50">
                  <div class="w-12 h-12 bg-blue-900/20 rounded-full flex items-center justify-center mx-auto mb-2">
                    <i class="fas fa-brain text-purple-400 text-xl"></i>
                  </div>
                  <h3 class="text-sm font-medium">Gênio</h3>
                  <p class="text-xs text-blue-300">Acerto 90% em um jogo</p>
                </div>

                <div class="achievement-card bg-blue-900/10 rounded-lg p-4 text-center border border-blue-800/30 opacity-50">
                  <div class="w-12 h-12 bg-blue-900/20 rounded-full flex items-center justify-center mx-auto mb-2">
                    <i class="fas fa-star text-blue-400 text-xl"></i>
                  </div>
                  <h3 class="text-sm font-medium">Estrela</h3>
                  <p class="text-xs text-blue-300">Complete 10 jogos</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Modal de Matchmaking -->
    <div id="matchmakingModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
      <div class="bg-white rounded-xl p-6 shadow-lg text-center w-80 animate-pulse">
        <h2 class="text-xl font-semibold mb-4">Procurando oponente...</h2>
        <div class="mb-4">
          <span class="text-4xl animate-spin inline-block">🎯</span>
        </div>
        <button id="cancelMatchmaking" class="mt-2 bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-full">
          Cancelar
        </button>
      </div>
    </div>

   
    <!-- Biblioteca do socket.io-client (vinda do servidor) -->
<script src="/socket.io/socket.io.js"></script>
<script type="module" src="/JS/dashboard/main.js"></script>
<script>
  document.addEventListener("DOMContentLoaded", () => {
    const token = localStorage.getItem("token");
    const id = localStorage.getItem("userId");

    if (!token) {
      window.location.href = "login.html";
      return;
    }

    // Busca os dados do usuário
    fetch(`http://localhost:3000/user/${id}`, {
      method: 'GET',
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${token}`
      }
    })
      .then(res => res.json())
      .then(data => {
        const user = data.user;
        document.getElementById("foto-usuario").src = user.img ||
          "https://i0.wp.com/digitalhealthskills.com/wp-content/uploads/2022/11/3da39-no-user-image-icon-27.png";
        document.getElementById("nome-usuario").textContent = user.nickname;
        const xpAtual = user.xp;
        const xpMaximo = 300;
        const pct = Math.min((xpAtual / xpMaximo) * 100, 100);
        document.querySelector(".bg-blue-500").style.width = `${pct}%`;
        document.querySelector(".text-xs.text-gray-400")
          .textContent = `XP: ${xpAtual} / ${xpMaximo}`;
      })
      .catch(err => console.error('ERRO:', err));

    // Matchmaking modal
    document.getElementById("btnEntrar").addEventListener("click", () => {
      document.getElementById("matchmakingModal").classList.remove("hidden");
    });
    document.getElementById("cancelMatchmaking").addEventListener("click", () => {
      document.getElementById("matchmakingModal").classList.add("hidden");
    });

    // Links da sidebar
    document.getElementById("dashboard-link")?.addEventListener("click", e => {
      e.preventDefault();
      console.log("Dashboard link clicked");
    });
    document.getElementById("community-link")?.addEventListener("click", e => {
      e.preventDefault();
      alert("Redirecionando para Comunidade");
    });
    document.getElementById("achievements-link")?.addEventListener("click", e => {
      e.preventDefault();
      alert("Redirecionando para Conquistas");
    });
    document.getElementById("stats-link")?.addEventListener("click", e => {
      e.preventDefault();
      alert("Redirecionando para Estatísticas");
    });
    document.getElementById("settings-link")?.addEventListener("click", e => {
      e.preventDefault();
      alert("Redirecionando para Configurações");
    });
    document.getElementById("logout-link")?.addEventListener("click", e => {
      e.preventDefault();
      localStorage.clear();
      window.location.href = "login.html";
    });

    // Upload de foto de perfil
    document.getElementById("uploadInput").addEventListener("change", function () {
      const file = this.files[0];
      if (!file) return;
      if (file.size > 50 * 1024 * 1024) {
        alert("Imagem muito grande!");
        this.value = "";
        return;
      }
      const reader = new FileReader();
      reader.onloadend = () => {
        fetch(`http://localhost:3000/user/photo/${id}`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
            'Authorization': `Bearer ${token}`
          },
          body: JSON.stringify({ base64Img: reader.result })
        })
          .then(res => res.json())
          .then(data => {
            document.getElementById('foto-usuario').src = data.updatedUser.img;
            this.value = "";
            console.log('Imagem atualizada com sucesso');
          })
          .catch(err => console.error('Erro ao enviar imagem:', err));
      };
      reader.readAsDataURL(file);
    });

  });
</script>
</body>
</html>